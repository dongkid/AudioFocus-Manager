# Audio Focus Manager (音频焦点管理器)

## 1. 项目简介

**Audio Focus Manager** 是一款专为 Windows 用户设计的智能音频管理工具。它能帮助您解决在欣赏音乐或观看视频时，被其他应用程序（如系统通知、聊天软件提示音、网页广告等）的声音打断的烦恼。

您可以指定一个主要的媒体应用（例如 Spotify, 网易云音乐, Chrome里的视频等）作为“锚定”目标。当本工具检测到任何其他程序开始播放声音时，它会自动暂停您锚定的媒体应用；当其他程序的声音停止后，它又会自动恢复播放。从此告别手动暂停和播放，享受沉浸式的影音体验。

## 2. 功能特性

- **自动暂停/播放**: 当非“锚定”应用播放声音时，自动暂停“锚定”应用；当干扰声消失后，自动恢复播放。
- **动态应用列表**: 实时扫描并显示当前系统中所有正在播放媒体的应用。
- **简单交互**: 清晰的图形用户界面（GUI），只需一键即可“锚定”或更换目标应用。
- **高效稳定**: 在后台线程中运行核心监控逻辑，不影响主界面的响应，CPU和内存占用低。

## 3. 工作原理

本工具的核心逻辑分为两部分：

1.  **媒体会话控制**: 通过 `Windows Runtime (WinRT)` API 获取系统中所有可控制的媒体会话（如 Spotify, Chrome, Groove Music 等）。这使得程序能够获取到应用的媒体信息（如歌曲标题）并向其发送“播放/暂停”指令。
2.  **音频活动监控**: 通过 `pycaw` 库深入 Windows 核心音频 API (Core Audio APIs)，遍历系统中的所有音频会话（Audio Sessions）。通过检查每个会话的音量电平，程序可以准确判断出除了被“锚定”的应用外，是否还有其他任何进程正在发出声音。

主程序在一个独立的后台线程中，每秒执行一次监控循环：
- 更新可控制的媒体应用列表并显示在GUI上。
- 检查是否有非“锚定”的应用正在播放音频。
- 根据检查结果，决定是否向“锚定”的应用发送暂停或播放命令。

## 4. 技术栈

- **语言**: Python 3
- **核心库**:
    - `tkinter`: 用于构建图形用户界面 (GUI)。
    - `pycaw`: 用于监控系统中各个应用的音频活动。
    - `pywinrt`: 用于与 Windows 媒体控制系统交互，实现对应用的播放/暂停控制。
    - `psutil`: 用于获取进程信息，辅助识别发声的应用。

## 5. 如何使用

1.  运行 `main.py` 启动程序。
2.  程序会自动检测并列出当前正在播放媒体的应用。
3.  在列表中找到您想作为主要播放器的应用（如 Spotify），点击右侧的“锚定”按钮。
4.  按钮变为“已锚定”状态，背景变色，表示设置成功。
5.  现在，当电脑上其他任何程序发出声音时，被锚定的应用就会自动暂停。当声音结束后，它会自动恢复播放。
6.  您可以随时点击其他应用的“锚定”按钮来更换目标。
